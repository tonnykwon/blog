---
title: "쇼핑몰 로그 데이터 고객 클러스터링"
date: 2019-07-29
categories: portfolio
mathjax: true
---

### 목적

수훨한 고객 관리를 위해 고객 집단을 세분화하여 시간에 따라 고객 분류



### 기간

2019.02.18 ~ 2019.03.25



### 방법

#### 1. 기본 고객 군집화

각 사용자가 어떤 카테고리의 물품을 얼마만큼 구매했는 지에 대한 로그 데이터를 통해서 사용자를 클러스터링했다. 기본적으로 고객은 충성 고객, 신규 고객, 이탈 고객 등 여러 집단으로 나누어지고, 시간에 따라 속하는 집단이 변한다고 가정했다. 군집을 나누는 방법에 따라 군집화는 밀도, 계층, 그리드 등 여러 방법이 있지만 시간에 따라 고객의 군집 이동을 보기 위해서는 군집의 중심점이 필요하다. 따라서, 중심점이 존재하는 K-means와 K-medoids 기법을 사용하였다. 일반적으로 군집 개수 설정에 있어서 Elbow method를 사용하지만 보다 자동화된 군집 개수 설정을 위해 Pham과 Dimov의 Selection of K in K-means clustering 논문에서 정의된 K군집 평가함수를 사용하였다. 이 군집 평가 함수는 K-1에 비하여 현재 K 군집의 거리가 얼만큼 줄었는 지를 통해 각 K 군집을 평가한다. 또 군집 내 데이터 거리와 군집간의 거리를 기반으로 평가하는 Silhouette Coefficient를 통하여 K 군집을 종합적으로 평가했다.



#### 2. 시간에 따른 고객 집단을 군집화

약 5천만 로그데이터 사용하여 570만명의 사용자 중 10%를 샘플링하여 주 간 활동 데이터를 기반으로 군집화하였다. 그 이후 4주 중 각각 주간 데이터를 기반으로 기존 학습된 군집화 모델로 분류를 진행한 뒤, 4주간의 군집 이동을 데이터로 만들었다. 이를 다시 군집화 진행하여 KPI(구매 금액, 체류 시간 등)을 기반으로 군집화된 군집을 이탈하려는 고객군인지 점점 구매를 하는 고객군인지 등으로 설정했다.



#### 3. 각 군집의 패턴 마이닝

각 고객 집단의 특성을 자세히 파악하기 위해서 각 집단의 행동 패턴(Sequential Pattern)을 마이닝했다. PreFixSpan을 통해 각 집단에서 나타나는 패턴을 추출했다.

<p align= 'center'>
    <img src = "../../assets/img/portfolio/2-pattern.png" width = "70%">
    <br/>
    <sub>각 군집 패턴 마이닝 샘플</sub>
</p>



### 개발 환경 및 언어

Python: numpy, pandas, scikit-learn, pyspark



### 참조 논문

- Pham, D. T., Dimov, S. S., & Nguyen, C. D. (2005). Selection of K in K-means clustering. *Proceedings of the Institution of Mechanical Engineers, Part C: Journal of Mechanical Engineering Science*, *219*(1), 103-119.